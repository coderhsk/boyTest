(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-835bd008"],{"17dc":function(t,e,a){"use strict";a("bdee")},"51f1":function(t,e,a){"use strict";a("78e5")},"647b":function(t,e,a){},"78e5":function(t,e,a){},"9a37":function(t,e,a){"use strict";a("a780")},"9bd0":function(t,e,a){"use strict";var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"tab-control"},t._l(t.titles,(function(e,s){return a("div",{key:s,staticClass:"tab-control-item",class:{active:t.currentIndex===s},on:{click:function(e){return t.btnClick(s)}}},[a("span",[t._v(t._s(e))])])})),0)},i=[],r={name:"TabControl",props:{titles:{type:Array,default(){return[]}}},data(){return{currentIndex:0}},methods:{btnClick(t){this.currentIndex=t,this.$emit("tabClick",t)}}},n=r,c=(a("17dc"),a("2877")),o=Object(c["a"])(n,s,i,!1,null,"0c2d178a",null);e["a"]=o.exports},a780:function(t,e,a){},bb51:function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"category"}},[a("nav-bar",{staticClass:"nav-bar"},[a("div",{attrs:{slot:"center"},slot:"center"},[t._v("商品分类")])]),a("div",{staticClass:"content"},[a("tab-menu",{attrs:{categories:t.categories},on:{selectItem:t.selectItem}}),a("scroll",{ref:"scroll",attrs:{id:"tab-content"}},[a("div",[a("tab-content-category",{attrs:{subcategories:t.showSubcategory}}),a("tab-control",{attrs:{titles:["综合","新品","销量"]},on:{tabClick:t.tabClick}}),a("goods-list",{attrs:{goods:t.showCategoryDetail}})],1)])],1)],1)},i=[],r=a("a7ac"),n=a("5d17"),c=a("9bd0"),o=a("6d71"),l=a("1bab");function u(){return Object(l["a"])({url:"/category"})}function d(t){return Object(l["a"])({url:"/subcategory",params:{maitKey:t}})}function g(t,e){return Object(l["a"])({url:"/subcategory/detail",params:{miniWallkey:t,type:e}})}var h=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("scroll",{attrs:{id:"tab-menu"}},[a("div",{staticClass:"menu-list"},t._l(t.categories,(function(e,s){return a("div",{key:s,staticClass:"menu-list-item",class:{active:s===t.currentIndex},on:{click:function(e){return t.itemClick(s)}}},[t._v(" "+t._s(e.title)+" ")])})),0)])},b=[],f={name:"TabMenu",components:{Scroll:n["a"]},props:{categories:{type:Array,default(){return[]}}},data(){return{currentIndex:0}},created(){},methods:{itemClick(t){this.currentIndex=t,this.$emit("selectItem",t)}}},m=f,y=(a("eba8"),a("2877")),p=Object(y["a"])(m,h,b,!1,null,"17c9c6b8",null),v=p.exports,_=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[t.subcategories.list?a("grid-view",{attrs:{cols:3,lineSpace:15,"v-margin":20}},t._l(t.subcategories.list,(function(e,s){return a("div",{key:s,staticClass:"item"},[a("a",{attrs:{href:e.link}},[a("img",{staticClass:"item-img",attrs:{src:e.image,alt:""}}),a("div",{staticClass:"item-text"},[t._v(t._s(e.title))])])])})),0):t._e()],1)},C=[],x=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{ref:"gridView",staticClass:"grid-view"},[t._t("default")],2)},I=[],D={name:"GridView",props:{cols:{type:Number,default:2},hMargin:{type:Number,default:8},vMargin:{type:Number,default:8},itemSpace:{type:Number,default:8},lineSpace:{type:Number,default:8}},mounted:function(){setTimeout(this._autoLayout,20)},updated:function(){this._autoLayout()},methods:{_autoLayout:function(){let t=this.$refs.gridView,e=t.children;t.style.padding=`${this.vMargin}px ${this.hMargin}px`;let a=(t.clientWidth-2*this.hMargin-(this.cols-1)*this.itemSpace)/this.cols;for(let s=0;s<e.length;s++){let t=e[s];t.style.width=a+"px",(s+1)%this.cols!==0&&(t.style.marginRight=this.itemSpace+"px"),s>=this.cols&&(t.style.marginTop=this.lineSpace+"px")}}}},k=D,w=(a("9a37"),Object(y["a"])(k,x,I,!1,null,"58a324f6",null)),$=w.exports,S={name:"TabContentCategory",components:{GridView:$},props:{subcategories:{type:Object,default(){return{}}}}},T=S,j=(a("51f1"),Object(y["a"])(T,_,C,!1,null,"341a4af6",null)),O=j.exports,L=a("b95e"),M=a("eecb"),N={name:"Category",components:{NavBar:r["a"],Scroll:n["a"],TabControl:c["a"],GoodsList:o["a"],TabMenu:v,TabContentCategory:O},mixins:[M["c"]],data(){return{categories:[],categoryData:{},currentIndex:-1,saveY:0}},computed:{showSubcategory(){return-1===this.currentIndex?{}:this.categoryData[this.currentIndex].subcategories},showCategoryDetail(){return-1===this.currentIndex?[]:this.categoryData[this.currentIndex].categoryDetail[this.currentType]}},created(){this._getCategory(),this.$bus.$on("itemImageLoad",()=>{this.$refs.scroll.refresh()})},activated(){this.$refs.scroll.scrollTo(0,this.saveY,100),this.$refs.scroll.refresh()},deactivated(){this.saveY=this.$refs.scroll.getSaveY(),this.$bus.$off("itemImageLoad",this.itemImgListener)},mounted(){},methods:{_getCategory(){u().then(t=>{this.categories=t.data.category.list;for(let e=0;e<this.categories.length;e++)this.categoryData[e]={subcategories:{},categoryDetail:{pop:[],new:[],sell:[]}};this._getSubcategories(0)})},_getSubcategories(t){this.currentIndex=t;const e=this.categories[t].maitKey;d(e).then(e=>{this.categoryData[t].subcategories=e.data,this.categoryData={...this.categoryData},this._getCategoryDetail(L["b"]),this._getCategoryDetail(L["c"]),this._getCategoryDetail(L["a"])})},_getCategoryDetail(t){const e=this.categories[this.currentIndex].miniWallkey;g(e,t).then(e=>{this.categoryData[this.currentIndex].categoryDetail[t]=e,this.categoryData={...this.categoryData}})},selectItem(t){this._getSubcategories(t)}}},E=N,V=(a("f3fc"),Object(y["a"])(E,s,i,!1,null,"369349b4",null));e["default"]=V.exports},bdee:function(t,e,a){},d93e:function(t,e,a){},eba8:function(t,e,a){"use strict";a("d93e")},f3fc:function(t,e,a){"use strict";a("647b")}}]);
//# sourceMappingURL=chunk-835bd008.554d1f14.js.map